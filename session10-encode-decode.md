# Session 10: エンコード・デコード ツールキット

tools24 リポジトリに `/encode-decode` ページを追加してください。
既存のコンポーネント・レイアウト・スタイルを踏襲すること。

---

## 完成イメージ

Base64、URLエンコード、JWTデコーダー、ハッシュ生成、Unicode変換を1ページにまとめた開発者向けツールキット。
タブ切り替えで各機能にアクセス。全処理クライアントサイド完結。

---

## 画面構成（1ページ完結・タブ切り替え）

### ヘッダー部
- ページタイトル: 「エンコード・デコード ツールキット」
- サブタイトル: 「Base64・URL・JWT・ハッシュ・Unicode変換をブラウザだけで」

### メインエリア: 5つのタブ

---

### タブ1: Base64 エンコード/デコード

**レイアウト:** 上下2段（入力 → 出力）

**入力エリア:**
- テキストエリア（モノスペースフォント、最低10行）
- placeholder: 「エンコードまたはデコードしたいテキストを入力」
- 「クリア」ボタン
- 文字エンコーディング選択: UTF-8（デフォルト）/ Shift_JIS / EUC-JP

**アクションボタン（横並び）:**
- 「エンコード ↓」（プライマリ）
- 「デコード ↓」（セカンダリ）

**出力エリア:**
- テキストエリア（読み取り専用）
- 「コピー」ボタン（クリック後「コピーしました ✓」）

**補足機能:**
- 入力/出力のバイト数を表示
- ファイルのBase64変換: ファイルドロップエリア（画像・PDF等 → Base64文字列に変換）
- Data URI形式出力トグル（`data:image/png;base64,...` 形式）

---

### タブ2: URLエンコード/デコード

**レイアウト:** 上下2段

**入力エリア:**
- テキストエリア
- placeholder: 「https://example.com/検索?q=日本語テスト」

**アクションボタン:**
- 「エンコード ↓」— encodeURIComponent 使用
- 「デコード ↓」— decodeURIComponent 使用
- 「全体エンコード ↓」— encodeURI 使用（パス区切りを保持）

**出力エリア:**
- テキストエリア（読み取り専用）
- 「コピー」ボタン

**補足機能:**
- encodeURI vs encodeURIComponent の違いを解説テキストで表示
- 日本語文字のエンコード結果にバイト列（%E6%97%A5 等）のUnicodeコードポイント対応表を表示
- 二重エンコード検出: 入力が既にエンコード済みかを自動判定して警告

---

### タブ3: JWTデコーダー

**レイアウト:** 入力（上） → 3セクション表示（下）

**入力エリア:**
- テキストエリア（1行表示推奨、横スクロール可）
- placeholder: 「eyJhbGciOiJIUzI1NiIs...」
- 入力と同時にリアルタイムデコード（デバウンス300ms）

**出力エリア（3セクション横並び or 縦積み）:**

**ヘッダー（赤系背景）:**
```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```
- JSON整形済み、シンタックスハイライト
- 「コピー」ボタン

**ペイロード（紫系背景）:**
```json
{
  "sub": "1234567890",
  "name": "山田太郎",
  "iat": 1516239022,
  "exp": 1516242622
}
```
- JSON整形済み、シンタックスハイライト
- `iat`、`exp`、`nbf` フィールドがあれば日本語の日時に自動変換して横に表示
  - 例: `"exp": 1516242622` → `2018年1月18日 10:10:22 (JST)`
- トークンの有効期限状態を表示:
  - 🟢「有効（残り○時間○分）」
  - 🔴「期限切れ（○日前に失効）」
- 「コピー」ボタン

**署名（水色系背景）:**
- 署名部分のBase64文字列を表示
- 「※署名の検証はサーバーサイドで秘密鍵が必要です」の注記

**エラー処理:**
- 不正なJWT → 「有効なJWTトークンではありません」エラー表示
- 3パート（header.payload.signature）に分割できない場合のエラー

---

### タブ4: ハッシュ生成

**レイアウト:** 入力（上） → 全ハッシュ結果一覧（下）

**入力エリア:**
- テキストエリア
- placeholder: 「ハッシュを生成したいテキストを入力」
- 入力モード切り替え: テキスト / ファイル（ドラッグ&ドロップ）

**出力エリア（入力と同時にリアルタイム生成）:**

| アルゴリズム | ハッシュ値 | コピー |
|-------------|----------|--------|
| MD5 | e10adc3949ba59abbe56e057f20f883e | 📋 |
| SHA-1 | 7c4a8d09ca3762af61e59520943dc26494f8941b | 📋 |
| SHA-256 | 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92 | 📋 |
| SHA-384 | ... | 📋 |
| SHA-512 | ... | 📋 |

- 大文字/小文字トグル
- 各行に個別コピーボタン
- 「全てコピー」ボタン（全アルゴリズムの結果をまとめてコピー）

**補足機能:**
- 2つの文字列のハッシュ比較モード: テキスト2つ入力 → 各ハッシュが一致するか ✅/❌ で表示
- ファイルのチェックサム検証: ファイルドロップ + 期待するハッシュ値入力 → 一致判定

**技術:** Web Crypto API (crypto.subtle.digest) を使用。MD5のみ自前実装（Web Crypto APIに含まれないため）。

---

### タブ5: Unicode変換

**レイアウト:** 入力（上） → 変換結果テーブル（下）

**入力エリア:**
- テキストエリア
- placeholder: 「日本語テスト ABC 123 🎉」
- 入力モード切り替え:
  - テキスト → Unicode各形式に変換
  - Unicodeエスケープ → テキストに逆変換

**出力エリア（リアルタイム変換）:**

| 形式 | 結果 | コピー |
|------|------|--------|
| Unicodeコードポイント | U+65E5 U+672C U+8A9E | 📋 |
| Unicodeエスケープ (JS) | \u65E5\u672C\u8A9E | 📋 |
| HTMLエンティティ (10進) | &#26085;&#26412;&#35486; | 📋 |
| HTMLエンティティ (16進) | &#x65E5;&#x672C;&#x8A9E; | 📋 |
| UTF-8バイト列 | E6 97 A5 E6 9C AC E8 AA 9E | 📋 |
| UTF-16バイト列 | 65E5 672C 8A9E | 📋 |
| パーセントエンコード | %E6%97%A5%E6%9C%AC%E8%AA%9E | 📋 |

**補足機能:**
- 1文字ごとの詳細表示トグル: 各文字のコードポイント・UTF-8バイト列・Unicode名を表示
- 全角→半角 / 半角→全角 変換ボタン（カタカナ・英数字）

---

## SEOコンテンツ（フッター上部、アコーディオン形式）

**「エンコードとは」**
データを特定の規則に従って別の形式に変換すること。Web開発ではBase64、URLエンコード、文字コード変換が頻繁に使われる。

**「各ツールの使い方」**
- Base64: 画像のインライン埋め込み、APIのBasic認証ヘッダー作成に
- URLエンコード: 日本語を含むURLパラメータの安全な送信に
- JWTデコード: APIの認証トークンの中身確認・デバッグに
- ハッシュ: ファイルの整合性チェック、パスワードのハッシュ確認に
- Unicode: 文字コード問題のデバッグ、特殊文字の調査に

**「よくある質問（FAQ）」**
- Q: Base64はデータの暗号化ですか？ → A: いいえ。Base64はエンコード（変換）であり暗号化ではありません。誰でもデコードできます。機密データの保護には暗号化を使用してください。
- Q: MD5は安全ですか？ → A: MD5は衝突耐性が破られているため、パスワードのハッシュや署名には推奨されません。ファイルのチェックサム用途なら問題ありません。セキュリティ用途にはSHA-256以上を使用してください。
- Q: JWTの署名を検証できますか？ → A: このツールではデコード（中身の確認）のみ可能です。署名の検証にはサーバーサイドで秘密鍵が必要です。
- Q: データはサーバーに送信されますか？ → A: いいえ、全てブラウザ内で処理されます。

---

## 技術要件

- **全処理クライアントサイド完結**
- ハッシュ生成: Web Crypto API (`crypto.subtle.digest`) — SHA系
- MD5: 軽量な自前実装（npm パッケージ不要、50行程度のピュアJS実装）
- JWT: 自前パース（Base64デコード + JSONパース、ライブラリ不要）
- Base64: btoa/atob + TextEncoder/TextDecoder
- URLエンコード: encodeURIComponent / encodeURI
- Unicode: String.prototype.codePointAt / String.fromCodePoint
- **レスポンシブ対応**: モバイルでは1カラム
- **ダークモード対応**: 既存のテーマ切り替えに追従
- 外部ライブラリ不要（全て標準API + 自前実装）

---

## SEO対策

メタデータ:
- title: 「エンコード・デコード ツールキット | Base64・URL・JWT・ハッシュ・Unicode変換」
- description: 「Base64エンコード、URLエンコード、JWTデコード、MD5/SHA ハッシュ生成、Unicode変換がブラウザだけで完結。日本語の文字コード処理にも完全対応。データはサーバーに送信されません。」
- keywords: 「base64 変換, url エンコード, jwt デコード, ハッシュ 生成, unicode 変換, sha256」

構造化データ: WebApplication schema
OGP設定
sitemap.xmlに追加

---

## ディレクトリ構造

```
src/
  app/
    encode-decode/
      page.tsx
  components/
    encode-decode/
      encode-decode-toolkit.tsx  # メインコンポーネント（タブ管理）
      base64-tab.tsx             # Base64 エンコード/デコード
      url-encode-tab.tsx         # URLエンコード/デコード
      jwt-decoder-tab.tsx        # JWTデコーダー
      hash-generator-tab.tsx     # ハッシュ生成
      unicode-converter-tab.tsx  # Unicode変換
  lib/
    encode-decode/
      base64.ts       # Base64ユーティリティ
      url-encode.ts   # URLエンコードユーティリティ
      jwt.ts          # JWTパーサー
      hash.ts         # ハッシュ生成（Web Crypto API + MD5自前実装）
      unicode.ts      # Unicode変換ユーティリティ
      md5.ts          # MD5ピュアJS実装
```

---

## 注意事項

- UIテキストは全て日本語
- エラーメッセージも日本語
- JWTデコーダーの時刻表示はJST
- MD5の自前実装はRFC 1321準拠
- ハッシュ生成はWeb Crypto APIが使えない環境（古いブラウザ）でのフォールバック不要（モダンブラウザのみ対象）
- 全てTypeScript
- 既存のsitemap.tsに /encode-decode を追加
- 既存のトップページのツール一覧に追加
- npm run build が通ることを確認
